# AI Innovation Challenge 2026 - ë°ì´í„°ë² ì´ìŠ¤ ì‹¤í–‰ ê°€ì´ë“œ

## ğŸ“‹ ì „ì²´ êµ¬ì¡° ìš”ì•½

### ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” (ì´ 6ê°œ)

```
1. brands               ë¸Œëœë“œ ì •ë³´ (ì´ˆê¸° 5ê°œ ë¸Œëœë“œ ìë™ ì‚½ì…)
2. products             ìƒí’ˆ ì •ë³´ (ë¹ˆ ìƒíƒœ - í¬ë¡¤ë§ ë°ì´í„° ì„í¬íŠ¸ í•„ìš”)
3. personas             í˜ë¥´ì†Œë‚˜ ì •ë³´ (ë¹ˆ ìƒíƒœ - í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì¶”ê°€)
4. product_personas     ìƒí’ˆ-í˜ë¥´ì†Œë‚˜ ë§¤í•‘ (ì¶”ì²œ ì‹œìŠ¤í…œìš©)
5. persona_analysis_results  í˜ë¥´ì†Œë‚˜ ë¶„ì„ ê²°ê³¼
6. persona_solutions    í˜ë¥´ì†Œë‚˜ ì†”ë£¨ì…˜
```

### í•µì‹¬ íŒŒì¼ êµ¬ì¡°

```
database/
â”œâ”€â”€ docker-compose.yml          # Docker ì„¤ì •
â”œâ”€â”€ .env                        # í™˜ê²½ë³€ìˆ˜ ì„¤ì •
â”œâ”€â”€ database.py                 # DB ì—°ê²° ì„¤ì •
â”œâ”€â”€ models.py                   # SQLAlchemy ORM ëª¨ë¸
â”œâ”€â”€ api_server.py               # FastAPI ì„œë²„
â”œâ”€â”€ test_connection.py          # DB ì—°ê²° í…ŒìŠ¤íŠ¸
â”œâ”€â”€ jsonl_to_sql.py             # JSONL â†’ SQL ë³€í™˜ ë„êµ¬
â”‚
â””â”€â”€ init/                       # SQL ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
    â”œâ”€â”€ 01-create-tables.sql    # í…Œì´ë¸” ìƒì„±
    â”œâ”€â”€ 02-seed-initial-data.sql # ë¸Œëœë“œ ì´ˆê¸° ë°ì´í„°
    â”œâ”€â”€ 04-insert-brands.sql    # (ìë™ìƒì„±) ì¶”ê°€ ë¸Œëœë“œ
    â”œâ”€â”€ 05-insert-products.sql  # (ìë™ìƒì„±) ìƒí’ˆ ë°ì´í„°
    â””â”€â”€ 06-insert-product-personas.sql  # (ìë™ìƒì„±) ë§¤í•‘ ë°ì´í„°
```

---

## ğŸš€ ë‹¨ê³„ë³„ ì‹¤í–‰ ë°©ë²•

### STEP 1: ë°ì´í„°ë² ì´ìŠ¤ ì‹œì‘

```bash
cd AI-INNOVATION-CHALLENGE-2026-hs_branch/database
docker-compose up -d
```

**ìë™ ì‹¤í–‰ ë‚´ìš©:**
- PostgreSQL ì»¨í…Œì´ë„ˆ ì‹œì‘ (í¬íŠ¸ 5432)
- pgAdmin ì»¨í…Œì´ë„ˆ ì‹œì‘ (í¬íŠ¸ 5050)
- `init/01-create-tables.sql` ì‹¤í–‰ â†’ 6ê°œ í…Œì´ë¸” ìƒì„±
- `init/02-seed-initial-data.sql` ì‹¤í–‰ â†’ 5ê°œ ë¸Œëœë“œ ì‚½ì…

**ì ‘ì† ì •ë³´:**
- PostgreSQL: `localhost:5432`
  - DB: `ai_innovation_db`
  - User: `postgres`
  - Password: `postgres123`

- pgAdmin: `http://localhost:5050`
  - Email: `admin@admin.com`
  - Password: `admin123`

---

### STEP 2: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸

```bash
cd AI-INNOVATION-CHALLENGE-2026-hs_branch/database
python test_connection.py
```

**í™•ì¸ ì‚¬í•­:**
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„±ê³µ
- âœ… 6ê°œ í…Œì´ë¸” ìƒì„± ì™„ë£Œ
- âœ… brands í…Œì´ë¸”: 5ê°œ ë¸Œëœë“œ
- âœ… personas í…Œì´ë¸”: 0ê°œ (ë¹ˆ ìƒíƒœ)
- âœ… products í…Œì´ë¸”: 0ê°œ (ë¹ˆ ìƒíƒœ)

---

### STEP 3: í¬ë¡¤ë§ ë°ì´í„° ì„í¬íŠ¸ (ì„ íƒ ì‚¬í•­)

**3-1. JSONL â†’ SQL ë³€í™˜**

```bash
cd AI-INNOVATION-CHALLENGE-2026-hs_branch/database
python jsonl_to_sql.py
```

**í•„ìš”í•œ íŒŒì¼:**
- `../../AI-INNOVATION-CHALLENGE-2026/data/crawling_result/*.jsonl`

**ìƒì„±ë˜ëŠ” íŒŒì¼:**
- `init/04-insert-brands.sql` - ë¸Œëœë“œ INSERT ë¬¸
- `init/05-insert-products.sql` - ìƒí’ˆ INSERT ë¬¸
- `init/06-insert-product-personas.sql` - ë§¤í•‘ INSERT ë¬¸

**3-2. SQL íŒŒì¼ ì‹¤í–‰**

```bash
# ë¸Œëœë“œ ì¶”ê°€ (ìˆìœ¼ë©´)
docker-compose exec -T postgres psql -U postgres ai_innovation_db < init/04-insert-brands.sql

# ìƒí’ˆ ì¶”ê°€
docker-compose exec -T postgres psql -U postgres ai_innovation_db < init/05-insert-products.sql

# ë§¤í•‘ ì¶”ê°€ (ì¶”ì²œ ë°ì´í„°ê°€ ìˆìœ¼ë©´)
docker-compose exec -T postgres psql -U postgres ai_innovation_db < init/06-insert-product-personas.sql
```

**ë˜ëŠ” Windows PowerShell:**

```powershell
Get-Content init\04-insert-brands.sql | docker exec -i ai-innovation-postgres psql -U postgres ai_innovation_db
Get-Content init\05-insert-products.sql | docker exec -i ai-innovation-postgres psql -U postgres ai_innovation_db
Get-Content init\06-insert-product-personas.sql | docker exec -i ai-innovation-postgres psql -U postgres ai_innovation_db
```

---

### STEP 4: API ì„œë²„ ì‹œì‘

```bash
cd AI-INNOVATION-CHALLENGE-2026-hs_branch/database
python api_server.py
```

**ì„œë²„ ì ‘ì†:**
- API ì„œë²„: `http://localhost:8000`
- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

---

## ğŸ“¡ API ì—”ë“œí¬ì¸íŠ¸

### 1. ë¸Œëœë“œ API

```bash
# ëª¨ë“  ë¸Œëœë“œ ì¡°íšŒ
GET http://localhost:8000/api/brands

# íŠ¹ì • ë¸Œëœë“œì˜ ìƒí’ˆ ì¡°íšŒ
GET http://localhost:8000/api/brands/{brand_id}/products
```

### 2. ìƒí’ˆ API

```bash
# ìƒí’ˆ ëª©ë¡ ì¡°íšŒ (í˜ì´ì§•)
GET http://localhost:8000/api/products?limit=20&offset=0

# ì¹´í…Œê³ ë¦¬ í•„í„°ë§
GET http://localhost:8000/api/products?category=ìŠ¤í‚¨ì¼€ì–´

# íŠ¹ì • ìƒí’ˆ ìƒì„¸ ì¡°íšŒ
GET http://localhost:8000/api/products/{product_id}
```

### 3. í˜ë¥´ì†Œë‚˜ API (í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™)

```bash
# í˜ë¥´ì†Œë‚˜ ìƒì„±
POST http://localhost:8000/api/personas
Content-Type: application/json

{
  "persona_key": "user_001",
  "name": "30ëŒ€ ê±´ì„± í”¼ë¶€ ì§ì¥ì¸",
  "description": "ê±´ì„± í”¼ë¶€ ê³ ë¯¼ì´ ìˆëŠ” 30ëŒ€ ì—¬ì„±",
  "gender": "ì—¬ì„±",
  "age_group": "30ëŒ€",
  "skin_types": ["ê±´ì„±", "ë¯¼ê°ì„±"],
  "personal_color": "ì›œí†¤",
  "base_shade": "21í˜¸",
  "skin_concerns": ["ê±´ì¡°", "ì£¼ë¦„", "íƒ„ë ¥"],
  "preferred_point_colors": ["ë² ì´ì§€", "ë¸Œë¼ìš´"],
  "preferred_ingredients": ["íˆì•Œë£¨ë¡ ì‚°", "ì„¸ë¼ë§ˆì´ë“œ", "ë ˆí‹°ë†€"],
  "avoided_ingredients": ["íŒŒë¼ë²¤", "ì•Œì½”ì˜¬"],
  "preferred_scents": ["ë¬´í–¥", "í”Œë¡œëŸ´"],
  "special_conditions": ["ì²œì—°/ìœ ê¸°ë†"],
  "budget_range": "ì¤‘"
}

# ëª¨ë“  í˜ë¥´ì†Œë‚˜ ì¡°íšŒ
GET http://localhost:8000/api/personas

# íŠ¹ì • í˜ë¥´ì†Œë‚˜ ì¡°íšŒ
GET http://localhost:8000/api/personas/{persona_key}

# í˜ë¥´ì†Œë‚˜ ìˆ˜ì •
PUT http://localhost:8000/api/personas/{persona_key}

# í˜ë¥´ì†Œë‚˜ ì‚­ì œ
DELETE http://localhost:8000/api/personas/{persona_key}
```

### 4. ì¶”ì²œ API

```bash
# íŠ¹ì • í˜ë¥´ì†Œë‚˜ì— ë§ëŠ” ì¶”ì²œ ìƒí’ˆ ì¡°íšŒ
GET http://localhost:8000/api/personas/{persona_key}/recommendations?limit=20
```

### 5. í—¬ìŠ¤ ì²´í¬

```bash
GET http://localhost:8000/health
```

---

## ğŸ”§ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬

### ë°ì´í„°ë² ì´ìŠ¤ ì¤‘ì§€

```bash
cd AI-INNOVATION-CHALLENGE-2026-hs_branch/database
docker-compose down
```

### ë°ì´í„°ë² ì´ìŠ¤ ì™„ì „ ì´ˆê¸°í™” (ë°ì´í„° ì‚­ì œ)

```bash
cd AI-INNOVATION-CHALLENGE-2026-hs_branch/database
docker-compose down -v
docker-compose up -d
```

### ë°ì´í„°ë² ì´ìŠ¤ ë¡œê·¸ í™•ì¸

```bash
docker-compose logs postgres
docker-compose logs pgadmin
```

### PostgreSQL ì§ì ‘ ì ‘ì†

```bash
docker exec -it ai-innovation-postgres psql -U postgres ai_innovation_db
```

**ìœ ìš©í•œ SQL ëª…ë ¹ì–´:**

```sql
-- ëª¨ë“  í…Œì´ë¸” ëª©ë¡
\dt

-- í…Œì´ë¸” êµ¬ì¡° í™•ì¸
\d brands
\d products
\d personas

-- ë¸Œëœë“œ ëª©ë¡
SELECT id, name FROM brands;

-- ìƒí’ˆ ìˆ˜ í™•ì¸
SELECT COUNT(*) FROM products;

-- í˜ë¥´ì†Œë‚˜ ëª©ë¡
SELECT persona_key, name, gender, age_group FROM personas;

-- ì¢…ë£Œ
\q
```

---

## ğŸ“Š ë°ì´í„° í™•ì¸ ì¿¼ë¦¬

### pgAdmin ë˜ëŠ” SQL í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‹¤í–‰

```sql
-- 1. ë¸Œëœë“œë³„ ìƒí’ˆ ìˆ˜
SELECT
    b.name AS brand_name,
    COUNT(p.id) AS product_count
FROM brands b
LEFT JOIN products p ON b.id = p.brand_id
GROUP BY b.name
ORDER BY product_count DESC;

-- 2. í˜ë¥´ì†Œë‚˜ ëª©ë¡
SELECT
    persona_key,
    name,
    gender,
    age_group,
    skin_types,
    skin_concerns
FROM personas
ORDER BY created_at DESC;

-- 3. í˜ë¥´ì†Œë‚˜ë³„ ì¶”ì²œ ìƒí’ˆ ìˆ˜
SELECT
    p.name AS persona_name,
    COUNT(pp.id) AS recommended_products
FROM personas p
LEFT JOIN product_personas pp ON p.id = pp.persona_id
GROUP BY p.name
ORDER BY recommended_products DESC;

-- 4. íŠ¹ì • í˜ë¥´ì†Œë‚˜ì˜ ì¶”ì²œ ìƒí’ˆ (ìƒìœ„ 10ê°œ)
SELECT
    pr.product_name,
    b.name AS brand_name,
    pr.category,
    pr.price,
    pp.relevance_score
FROM product_personas pp
JOIN personas p ON pp.persona_id = p.id
JOIN products pr ON pp.product_id = pr.id
JOIN brands b ON pr.brand_id = b.id
WHERE p.persona_key = 'user_001'
ORDER BY pp.relevance_score DESC
LIMIT 10;
```

---

## ğŸ› ë¬¸ì œ í•´ê²°

### 1. í¬íŠ¸ ì¶©ëŒ ë¬¸ì œ

**ì¦ìƒ:** `port is already allocated`

**í•´ê²°:**
```bash
# ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ í™•ì¸
docker ps

# ì¶©ëŒí•˜ëŠ” ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker stop <container_id>

# ë˜ëŠ” .env íŒŒì¼ì—ì„œ í¬íŠ¸ ë³€ê²½
POSTGRES_PORT=5433
PGADMIN_PORT=5051
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:** `Connection refused`

**í•´ê²°:**
```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose ps

# ë¡œê·¸ í™•ì¸
docker-compose logs postgres

# ì¬ì‹œì‘
docker-compose restart postgres
```

### 3. SQL íŒŒì¼ ì„í¬íŠ¸ ì‹¤íŒ¨

**ì¦ìƒ:** `No such file or directory`

**í•´ê²°:**
```bash
# íŒŒì¼ ì¡´ì¬ í™•ì¸
ls -la init/

# JSONL ë³€í™˜ ë‹¤ì‹œ ì‹¤í–‰
python jsonl_to_sql.py

# Windowsì—ì„œëŠ” PowerShell ì‚¬ìš©
Get-Content init\05-insert-products.sql | docker exec -i ai-innovation-postgres psql -U postgres ai_innovation_db
```

### 4. API ì„œë²„ ì‹¤í–‰ ì‹¤íŒ¨

**ì¦ìƒ:** `ModuleNotFoundError`

**í•´ê²°:**
```bash
# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt

# í™˜ê²½ í™•ì¸
python --version
pip list
```

---

## ğŸ“ ì¤‘ìš” íŒŒì¼ ì„¤ëª…

### database.py
- PostgreSQL ì—°ê²° ì„¤ì •
- SQLAlchemy ì—”ì§„ ë° ì„¸ì…˜ ê´€ë¦¬
- `get_db()` í•¨ìˆ˜: FastAPI Dependsìš©

### models.py
- 6ê°œ í…Œì´ë¸”ì˜ SQLAlchemy ORM ëª¨ë¸
- Brand, Product, Persona, ProductPersona, PersonaAnalysisResult, PersonaSolution

### api_server.py
- FastAPI ê¸°ë°˜ REST API ì„œë²„
- CORS ì„¤ì • í¬í•¨
- Pydantic ëª¨ë¸ë¡œ ìš”ì²­/ì‘ë‹µ ê²€ì¦

### jsonl_to_sql.py
- í¬ë¡¤ë§ ë°ì´í„°(JSONL) â†’ SQL INSERT ë¬¸ ë³€í™˜
- `ìƒì„±ëœ_ë¬¸ì„œ` â†’ `generated_document` ë§¤í•‘
- ë°°ì¹˜ INSERTë¡œ ì„±ëŠ¥ ìµœì í™”

### test_connection.py
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í…ŒìŠ¤íŠ¸
- í…Œì´ë¸” ìƒì„± í™•ì¸
- ê¸°ë³¸ ë°ì´í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸

---

## ğŸ’¡ ê°œë°œ íŒ

### 1. API í…ŒìŠ¤íŠ¸ ë„êµ¬

**Swagger UI (ì¶”ì²œ):**
- `http://localhost:8000/docs`
- ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ API í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

**curl:**
```bash
# ë¸Œëœë“œ ëª©ë¡ ì¡°íšŒ
curl http://localhost:8000/api/brands

# í˜ë¥´ì†Œë‚˜ ìƒì„±
curl -X POST http://localhost:8000/api/personas \
  -H "Content-Type: application/json" \
  -d @persona_example.json
```

**Python requests:**
```python
import requests

# ë¸Œëœë“œ ëª©ë¡ ì¡°íšŒ
response = requests.get('http://localhost:8000/api/brands')
print(response.json())

# í˜ë¥´ì†Œë‚˜ ìƒì„±
persona_data = {
    "persona_key": "user_001",
    "name": "30ëŒ€ ê±´ì„± í”¼ë¶€ ì§ì¥ì¸",
    # ... ë‚˜ë¨¸ì§€ í•„ë“œ
}
response = requests.post(
    'http://localhost:8000/api/personas',
    json=persona_data
)
print(response.json())
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…

```bash
# ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
docker exec ai-innovation-postgres pg_dump -U postgres ai_innovation_db > backup.sql

# ë³µì›
docker exec -i ai-innovation-postgres psql -U postgres ai_innovation_db < backup.sql
```

### 3. ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§

```bash
# API ì„œë²„ ë¡œê·¸
python api_server.py

# PostgreSQL ë¡œê·¸
docker-compose logs -f postgres
```

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

1. âœ… **STEP 1-2 ì™„ë£Œ:** ë°ì´í„°ë² ì´ìŠ¤ ê¸°ë³¸ ì„¤ì • ì™„ë£Œ
2. â³ **STEP 3 (ì„ íƒ):** í¬ë¡¤ë§ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì„í¬íŠ¸
3. â³ **STEP 4:** API ì„œë²„ ì‹œì‘ ë° í…ŒìŠ¤íŠ¸
4. â³ **í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™:** í˜ë¥´ì†Œë‚˜ ìƒì„± API í˜¸ì¶œ
5. â³ **ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„:** product_personas ë°ì´í„° ìƒì„±

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

- `SETUP_GUIDE.md` - ìƒì„¸ ì„¤ì • ê°€ì´ë“œ
- `FINAL_STRUCTURE.md` - ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ìƒì„¸ ë¬¸ì„œ
- `ì˜ˆìƒí…Œì´ë¸”.md` - ì´ˆê¸° í…Œì´ë¸” ì„¤ê³„ ë¬¸ì„œ
- `README.md` - í”„ë¡œì íŠ¸ ê°œìš”
